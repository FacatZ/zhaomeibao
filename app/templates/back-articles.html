<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>文章列表</title>
    <link rel="stylesheet" href="/static/style/bootstrap.css">
    <link rel="stylesheet" href="/static/style/back.css">
    <link href="/static/style/back-common.css" rel="stylesheet">
</head>
<body>
      {% include 'util/admin/top.html' %}

      {% include 'util/admin/left-box.html' %}
	<div class="backArticleBox">
    <div class="backArticleName">文章列表</div>
		<table class="backArticleMenuBox" border="1">
			<tr>
				<td class="backArticleMenuNew"><a href="#"></a></td>
				<td class="backArticleMenuSave"><a href="#"></a></td>
				<td class="backArticleMenuSee"><a href="#"></a></td>
				<td class="backArticleMenuDelete"><a href="#"></a></td>
			</tr>
		</table>
		<div class="backArticleMenuOptions">
			<select name="cars" class="form-control">
				<option value="all">所有类别</option>
				<option value="option1">类别1</option>
				<option value="option2">类别2</option>
				<option value="option3">类别3</option>
			<div class="form-group">
    			<input type="text" class="form-control" placeholder="搜索文章">
    			<button class="btn btn-default">搜索</button>
    		</div>
		<div class="backArticleTable">
    	<div class="checkboxNormal">
      	<input type="checkbox">
      	<div class="checkboxID">ID</div>
      	<div class="checkboxTitle">标题</div>
      	<div class="checkboxType">类别</div>
      	<div class="checkboxOrigin">作者</div>
      	<div class="checkboxDate">日期</div>
      	<div class="checkboxOption">操作</div>
    	</div>
      {% for article in articles %}
    	<div class="checkboxNormal">
      	<input type="checkbox">
      	<div class="checkboxID">{{article.id}}</div>
      	<div class="checkboxTitle">{{article.title|article_title_filter}}</div>
      	<div class="checkboxType">{{article.category.name}}</div>
      	<div class="checkboxOrigin">{{article.author.username}}</div>
      	<div class="checkboxDate">{{format_datetime(article.rldate)}}</div>
      	<div class="checkboxOption">
      		<table border="1">
      			<tr>
      				<td><a class="checkboxOptionEdit" href="{{url_for('admin.modify_article', id=article.id)}}"></a></td>
      				<td><a class="checkboxOptionSee" href="{{url_for('main.article', id=article.id)}}"></a></td>
      				<td><a class="checkboxOptionDelete" href="#"></a></td>
      			</tr>
      		</table>
      	</div>
    	</div>
      {% endfor %}
    	<div class="stockButtonBox">
            <div class="stockButtons">
        <input type="button" class="stockButton stockButtonPre" {% if pagination.has_prev %}url="{{url_for('admin.article_list', page=pagination.page-1, count=count)}}"{% endif %}>
        {% for p in pagination.iter_pages() %}
          {% if p %}
            {% if p == pagination.page %}
            <input type="button" class="stockButton activeButton" disabled="disabled" url="{{url_for('admin.article_list', page=p,count=count)}}" value="{{p}}">
            {% else %}
            <input type="button" class="stockButton" url="{{ url_for('admin.article_list', page=p, count=count)}}" value="{{p}}">
            {% endif %}
            
          {% else %}
            <input type="button" class="stockButton" value="...">
          {% endif %}
        {% endfor %}
        <input type="button" class="stockButton stockButtonNext" {% if pagination.has_next %}url="{{url_for('admin.article_list', page=pagination.page+1,count=count)}}"{% endif %} value=" ">
            </div>
		</div>
		</div>
	</div>	
  <script src="/static/js/jquery.js"></script>
  <script src="/static/js/bootstrap.js"></script>
  <script src="/static/js/jquery.SuperSlide.2.1.1.js"></script>
  <script type="text/javascript" src="/static/js/paginationbutton.js"></script>
  <script type="text/javascript">
    $('.checkboxOptionDelete').click(function(){
      var issueID = $(this).parents('.checkboxOption').siblings('.checkboxID').text();
      $.ajax({
        type:'get',
        url : '/api/admin/delete/article/' + issueID,
        success : function(data) {
          alert('删除成功');
          window.location.reload();
        },
        error : function(){
          alert('通信出问题了'); 
        }
      });
    });
  </script>
</body>
</html>